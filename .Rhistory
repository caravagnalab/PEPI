data_inference <- readRDS("~/Dropbox/stick-breaking/figure_paper_stat/data/data_inference.rds")
data_inference
setwd("~/Dropbox/stick-breaking/figure_paper_stat")
library(dplyr)
data_inference <- readRDS("~/Dropbox/stick-breaking/figure_paper_stat/data/data_inference.rds")
data_inference
library(ggplot2)
data = data_inference
data
data[j,]
data[j,]
j = 1
data[j,]
data
data$data
data[1,]$data
data[1,]$data[[1]]
data[1,]$data[[1]] %>% pull(node)
tree = data[j,]$tree[[1]]
spectrum = data[j,]$data[[1]]
len = data[j,]$length
mu = data[j,]$mu
tree = data[j,]$tree[[1]]
spectrum = data[j,]$data[[1]]
len = data[j,]$len
mu = data[j,]$mu
tree
spectrum
len
mu
library(PEPI)
plot_multivariate(spectrum)
plot_tree(tree)
library(PEPI)
library(rstan)
library(cmdstanr)
library(dplyr)
library(MCMCprecision)
library(VGAM)
library(ggplot2)
library(ape)
library(ggtree)
library(treeio)
library(ggpubr)
library(parallel)
plot_tree(tree)
plot_marginal(spectrum)
setwd("~/")
library(PEPI)
library(rstan)
library(cmdstanr)
library(dplyr)
library(MCMCprecision)
library(VGAM)
library(ggplot2)
library(ape)
library(ggtree)
library(treeio)
library(ggpubr)
library(parallel)
j = 1
path = "~scratch/pepi"
data <- readRDS("~/Orfeo/pepi/data/data_inference.rds")
data
tree = data[j,]$tree[[1]]
spectrum = data[j,]$data[[1]]
len = data[j,]$len
mu = data[j,]$mu
x = init_vaf(data = spectrum)
spectrum
tree = data[j,]$tree[[1]]
spectrum = data[j,]$data[[1]]
spectrum = spectrum %>%
mutate(Nx = round(Nx),Ny = round(Ny),DPx = round(DPx),DPy = round(DPy))
len = data[j,]$len
mu = data[j,]$mu
x = init_vaf(data = spectrum)
as.integer()
tree = data[j,]$tree[[1]]
spectrum = data[j,]$data[[1]]
spectrum = spectrum %>%
mutate(Nx = as.integer(Nx),Ny = as.integer(Ny),DPx = as.integer(DPx),DPy = as.integer(DPy))
len = data[j,]$len
mu = data[j,]$mu
x = init_vaf(data = spectrum)
x
tree
ggplot(data.frame(x = rbeta(1e-4,1e-8))) + geom_point(aes(x = x))
ggplot(data.frame(x = rbeta(1,1e-4,1e-8))) + geom_point(aes(x = x))
ggplot(data.frame(x = rbeta(1,1e-4,1e-8))) + geom_histogram(aes(x = x))
data.frame(x = rbeta(1,1e-4,1e-8))
ggplot(data.frame(x = rbeta(1000000,1e-4,1e-8))) + geom_histogram(aes(x = x))
ggplot(data.frame(x = rbeta(1000000,1e-4,1e7))) + geom_histogram(aes(x = x))
rn = 1/1e4
rp = 1/1e4
varn = rn/1e3
varp = rp/1e3
varn = rn/1e4
varp = rp/1e4
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
rn = 1/6000
rp = 1/9000
varn = rn/1e4
varp = rp/1e4
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
ggplot(data.frame(x = rbeta(10000,ap,bp))) + geom_histogram(aes(x = x))
1/6000
1/9000
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
ggplot(data.frame(x = rbeta(10000,ap,bp))) + geom_histogram(aes(x = x))
rn = 1e-5
rp = 1e-5
varn = rn/1e4
varp = rp/1e4
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
ggplot(data.frame(x = rbeta(10000,ap,bp))) + geom_histogram(aes(x = x))
setwd("~/Documents/GitHub/PEPI")
x = fit_tree(x,path_to_model =  "models",
cmdstan_path = "/opt/anaconda3/envs/stan/bin/cmdstan/",
max_depth = 3,ndraws = 1000,
init = NULL, seed = j,
mu = mu,l = len,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1e-5,qn = 1e4,rate_p = 1e-5,
qp = 1e4,k = 1e4,gamma = 150)
x$inference$tree$cmdstan_summary()
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
