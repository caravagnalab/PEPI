x = fit$inferece$tree
params = x$summary() %>% as_tibble() %>% dplyr::rename(param = variable)
M = fit$stan_data$delta_m_n
means = params %>% dplyr::select(param,mean)
rn = means %>% filter(param == "rn") %>% pull(mean)
rp = means %>% filter(param == "rp") %>% pull(mean)
max_depth = gsub(x = params %>% filter(grepl(x = param,pattern = "vaf_minus")) %>% pull(param),
pattern = "vaf_minus_",replacement = "") %>%
nchar() %>% max() - 1
tree = data.frame(node = "n",
level = 0,
delta_m = M,
phi = 1,
p_switch = 1,
nu = means %>% filter(param == "nu_n") %>% pull(mean),
rate = rn,
vaf_minus = means %>% filter(param == "vaf_minus_n") %>% pull(mean),
vaf_plus = means %>% filter(param == "vaf_plus_n") %>% pull(mean)) %>% mutate(m = nu*M)
for(l in 1:max_depth){
epsilon = tree %>% filter(level == l-1)
nod = epsilon %>% pull(node)
muts = epsilon %>% pull(m)
delta_muts = epsilon %>% pull(delta_m)
new =  lapply(1:length(nod), function(i){
phi =  means %>% filter(param == paste0("phi_",nod[i],"n")) %>% pull(mean)
new_nodes = tibble(node = c(paste0(nod[i],"n"),paste0(nod[i],"p")), level = l,
rate = c(rn,rp), phi = c(phi,1-phi)) %>% rowwise() %>%
mutate(delta_m = (delta_muts[i] - muts[i])*phi,
vaf_minus = ifelse(paste0("vaf_minus_",node) %in% params$param,
means %>% filter(param == paste0("vaf_minus_",node)) %>% pull(mean),0),
vaf_plus = ifelse(paste0("vaf_plus_",node) %in% params$param,
means %>% filter(param == paste0("vaf_plus_",node)) %>% pull(mean),0))
if(l < max_depth){
new_nodes = new_nodes %>% rowwise() %>%
mutate(p_switch = 1 - exp(-rate*delta_m),
nu = means %>% filter(param == paste0("nu_",node)) %>% pull(mean)
) %>%
mutate(m = nu*delta_m)
}else{
new_nodes =  new_nodes %>%
mutate(p_switch = 0, nu = 1, m = delta_m)
}
new_nodes
}) %>% bind_rows()
tree = rbind(tree,new)
}
tree$node = gsub(x = tree$node,pattern = "n",replacement = "-")
tree$node = gsub(x = tree$node,pattern = "p",replacement = "+")
tree = tree %>% mutate(pi = m/M) %>% as_tibble()
# tree pruning
if(!is.null(threshold)){
tree = filter_nodes(tree,threshold)
nodes = tree %>% pull(node)
tree = tree %>% mutate(leave = ifelse(!paste0(node,"-") %in% nodes,T,F))
leaves = tree %>% filter(leave) %>% pull(node)
for (leav in leaves){
v_m = ifelse(substr(x = leav,start = nchar(leav),stop = nchar(leav)) == "-",
tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(vaf_minus),1e-6)
v_p = ifelse(substr(x = leav,start = nchar(leav),stop = nchar(leav)) == "+",
tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(vaf_plus),1e-6)
delt_m = (tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(delta_m) - tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(m))*(tree %>% filter(node == leav) %>% pull(phi))
tree = tree %>% rowwise() %>%
mutate(vaf_minus = ifelse(node == leav,v_m,vaf_minus),
vaf_plus = ifelse(node == leav,v_p,vaf_plus),
delta_m = ifelse(node == leav,delt_m,delta_m),
m = ifelse(node == leav,delt_m,m)) %>% ungroup()
}
}
fit$inferred_tree = tree
fit$epimutation_threshold = threshold
return(fit)
}
get_average_tree(fit = tree,threshold = 0.1)
x
fit = X
fit = x
x = fit$inferece$tree
params = x$summary() %>% as_tibble() %>% dplyr::rename(param = variable)
x = fit$inference$tree
params = x$summary() %>% as_tibble() %>% dplyr::rename(param = variable)
M = fit$stan_data$delta_m_n
means = params %>% dplyr::select(param,mean)
rn = means %>% filter(param == "rn") %>% pull(mean)
rp = means %>% filter(param == "rp") %>% pull(mean)
max_depth = gsub(x = params %>% filter(grepl(x = param,pattern = "vaf_minus")) %>% pull(param),
pattern = "vaf_minus_",replacement = "") %>%
nchar() %>% max() - 1
tree = data.frame(node = "n",
level = 0,
delta_m = M,
phi = 1,
p_switch = 1,
nu = means %>% filter(param == "nu_n") %>% pull(mean),
rate = rn,
vaf_minus = means %>% filter(param == "vaf_minus_n") %>% pull(mean),
vaf_plus = means %>% filter(param == "vaf_plus_n") %>% pull(mean)) %>% mutate(m = nu*M)
x = fit$inference$treex
x = fit$inference$tree
x
params = x$summary() %>% as_tibble() %>% dplyr::rename(param = variable)
params
M = fit$stan_data$delta_m_n
means = params %>% dplyr::select(param,mean)
rn = means %>% filter(param == "rn") %>% pull(mean)
rp = means %>% filter(param == "rp") %>% pull(mean)
max_depth = gsub(x = params %>% filter(grepl(x = param,pattern = "vaf_minus")) %>% pull(param),
pattern = "vaf_minus_",replacement = "") %>%
nchar() %>% max() - 1
max_depth = fit$max_depth
tree = data.frame(node = "n",
level = 0,
delta_m = M,
phi = 1,
p_switch = 1,
nu = means %>% filter(param == "nu_n") %>% pull(mean),
rate = rn,
vaf_minus = means %>% filter(param == "vaf_minus_n") %>% pull(mean),
vaf_plus = means %>% filter(param == "vaf_plus_n") %>% pull(mean)) %>% mutate(m = nu*M)
max_depth
means %>% filter(param == "nu_n") %>% pull(mean)
data.frame(node = "n",
level = 0,
delta_m = M,
phi = 1,
p_switch = 1,
nu = means %>% filter(param == "nu_n") %>% pull(mean),
rate = rn,
vaf_minus = means %>% filter(param == "vaf_minus_n") %>% pull(mean),
vaf_plus = means %>% filter(param == "vaf_plus_n") %>% pull(mean))
M
M = fit$stan_data$tree$delta_m_n
means = params %>% dplyr::select(param,mean)
rn = means %>% filter(param == "rn") %>% pull(mean)
rp = means %>% filter(param == "rp") %>% pull(mean)
max_depth = fit$max_depth
tree = data.frame(node = "n",
level = 0,
delta_m = M,
phi = 1,
p_switch = 1,
nu = means %>% filter(param == "nu_n") %>% pull(mean),
rate = rn,
vaf_minus = means %>% filter(param == "vaf_minus_n") %>% pull(mean),
vaf_plus = means %>% filter(param == "vaf_plus_n") %>% pull(mean)) %>% mutate(m = nu*M)
tree
for(l in 1:max_depth){
epsilon = tree %>% filter(level == l-1)
nod = epsilon %>% pull(node)
muts = epsilon %>% pull(m)
delta_muts = epsilon %>% pull(delta_m)
new =  lapply(1:length(nod), function(i){
phi =  means %>% filter(param == paste0("phi_",nod[i],"n")) %>% pull(mean)
new_nodes = tibble(node = c(paste0(nod[i],"n"),paste0(nod[i],"p")), level = l,
rate = c(rn,rp), phi = c(phi,1-phi)) %>% rowwise() %>%
mutate(delta_m = (delta_muts[i] - muts[i])*phi,
vaf_minus = ifelse(paste0("vaf_minus_",node) %in% params$param,
means %>% filter(param == paste0("vaf_minus_",node)) %>% pull(mean),0),
vaf_plus = ifelse(paste0("vaf_plus_",node) %in% params$param,
means %>% filter(param == paste0("vaf_plus_",node)) %>% pull(mean),0))
if(l < max_depth){
new_nodes = new_nodes %>% rowwise() %>%
mutate(p_switch = 1 - exp(-rate*delta_m),
nu = means %>% filter(param == paste0("nu_",node)) %>% pull(mean)
) %>%
mutate(m = nu*delta_m)
}else{
new_nodes =  new_nodes %>%
mutate(p_switch = 0, nu = 1, m = delta_m)
}
new_nodes
}) %>% bind_rows()
tree = rbind(tree,new)
}
tree$node = gsub(x = tree$node,pattern = "n",replacement = "-")
tree$node = gsub(x = tree$node,pattern = "p",replacement = "+")
tree = tree %>% mutate(pi = m/M) %>% as_tibble()
if(!is.null(threshold)){
tree = filter_nodes(tree,threshold)
nodes = tree %>% pull(node)
tree = tree %>% mutate(leave = ifelse(!paste0(node,"-") %in% nodes,T,F))
leaves = tree %>% filter(leave) %>% pull(node)
for (leav in leaves){
v_m = ifelse(substr(x = leav,start = nchar(leav),stop = nchar(leav)) == "-",
tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(vaf_minus),1e-6)
v_p = ifelse(substr(x = leav,start = nchar(leav),stop = nchar(leav)) == "+",
tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(vaf_plus),1e-6)
delt_m = (tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(delta_m) - tree %>% filter(node == substr(x = leav,start = 1,stop = nchar(leav)-1)) %>%
pull(m))*(tree %>% filter(node == leav) %>% pull(phi))
tree = tree %>% rowwise() %>%
mutate(vaf_minus = ifelse(node == leav,v_m,vaf_minus),
vaf_plus = ifelse(node == leav,v_p,vaf_plus),
delta_m = ifelse(node == leav,delt_m,delta_m),
m = ifelse(node == leav,delt_m,m)) %>% ungroup()
}
}
fit$inferred_tree = tree
fit$epimutation_threshold = threshold
fit
class(fit)
x
class(fit)
fit$inferred_tree
x = fit_tree(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
max_depth = 3,ndraws = 1000,
init = list(list(rn = 1/6000,rp = 1/9000)), seed = 30,
mu = 1e-7,l = 2.7*10^9,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1/5000,qn = 1e3,rate_p = 1/5000,
qp = 1e3,k = 1e4,gamma = 200)
x
x = fit
fit_tree = function(x,path_to_model,cmdstan_path,
max_depth = 2,ndraws = 1000,init = NULL,seed = 15,
mu = 1e-7,l = 2.7*10^9,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1e-3,qn = 1e4,rate_p = 1e-3,
qp = 1e4,k = 1e4,gamma = 150){
dir.create(path_to_model)
cmdstanr::set_cmdstan_path(cmdstan_path)
spectrum = x$VAF
if(is.null(spectrum)){
stop("no VAF spectrum")
}
model = tree_inference_code(max_depth = max_depth,likelihood = T)
if(! paste0("tree_inference_depth_",max_depth,".stan") %in% list.files(path_to_model)){
write_stan_file(
model,
dir = ".",
basename = paste0(path_to_model,"/tree_inference_depth_",max_depth,".stan"),
force_overwrite = FALSE,
hash_salt = ""
)
}
data = list(
delta_m_n = spectrum %>% nrow(),
mu = mu,
l = l,
nu_t = nu_t,
qt = qt,
rate_n = rate_n,
qn = qn,
rate_p = rate_p,
qp = qp,
n = nrow(spectrum),
Nn = spectrum$Nx,
Np = spectrum$Ny,
DPn = spectrum$DPx,
DPp = spectrum$DPy,
gamma = gamma,
rho_n = rho_n,
rho_p = rho_p,
k = k)
file = paste0(path_to_model,"/tree_inference_depth_",max_depth,".stan")
mod = cmdstan_model(file)
fit = mod$variational(data = data, seed = seed,
init = init,
output_samples = ndraws,
algorithm="fullrank")
pepi = list(inference = list(tree = fit),stan_data = list(tree = data), max_depth = max_depth)
x$inference$tree = fit
x$stan_data$tree = data
x$max_depth = max_depth
return(x)
}
x = fit_tree(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
max_depth = 3,ndraws = 1000,
init = list(list(rn = 1/6000,rp = 1/9000)), seed = 30,
mu = 1e-7,l = 2.7*10^9,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1/5000,qn = 1e3,rate_p = 1/5000,
qp = 1e3,k = 1e4,gamma = 200)
x
x = init_vaf(data = spectrum)
x
x = fit_tree(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
max_depth = 3,ndraws = 1000,
init = list(list(rn = 1/6000,rp = 1/9000)), seed = 30,
mu = 1e-7,l = 2.7*10^9,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1/5000,qn = 1e3,rate_p = 1/5000,
qp = 1e3,k = 1e4,gamma = 200)
x
get_average_tree(x,threshold = 0.1)
source('~/Documents/GitHub/ProjectPepi/R/getters.R')
get_average_tree(x,threshold = 0.1)
x$inference$tree$cmdstan_summary()
1/7000
1/8000
x
get_average_tree(x,threshold = 0.1)
rn = 1/7000
rp = 1/8000
varn = rn/1e3
varp = rp/1e3
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
rn = 1/7000
rp = 1/8000
varn = rn/1e4
varp = rp/1e4
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
rn = 1/10000
rp = 1/10000
varn = rn/1e4
varp = rp/1e4
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
rn = 1/10000
rp = 1/10000
varn = rn/1e3
varp = rp/1e3
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
rn = 1/1e4
rp = 1/1e4
varn = rn/1e3
varp = rp/1e3
an = (rn*(1-rn)/varn - 1)*rn
bn = (rn*(1-rn)/varn - 1)*(1-rn)
ap = (rp*(1-rp)/varp - 1)*rp
bp = (rp*(1-rp)/varp - 1)*(1-rp)
ggplot(data.frame(x = rbeta(10000,an,bn))) + geom_histogram(aes(x = x))
x = fit_tree(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
max_depth = 3,ndraws = 1000,
init = list(list(rn = 1/6000,rp = 1/9000)), seed = 50,
mu = 1e-7,l = 2.7*10^9,rho_n = 1,rho_p = 1,nu_t = 0.1,
qt = 1e4,rate_n = 1e-4,qn = 1e3,rate_p = 1e-4,
qp = 1e3,k = 1e4,gamma = 200)
x$inference$tree$cmdstan_summary()
an
bn
1/7000
1/8000
get_average_tree(x,threshold = 0.1)
x = get_average_tree(x)
x$inf_tree
x$inferred_tree
tree
1/7000
1/8000
x = get_clusters(x)
p1 = plot_multivariate(x)
p1 = plot_multivariate(x)
x$VAF
spectrum %>% mutate(vaf_x = Nx/DPx, vaf_y = Ny/DPy)
source('~/Documents/GitHub/ProjectPepi/R/plot_functions.R')
p1 = plot_multivariate(x)
p2 = plot_tree(x)
p3 = plot_marginal(x)
p = ggarrange(plotlist = list(p1,p2),ncol = 2,nrow = 1)
p
x = get_average_tree(x,threshold = 0.05)
x$inferred_tree
x = get_average_tree(x,threshold = 0.1)
x$inferred_tree
get_average_tree(x,threshold = 0.1)
get_average_tree(x,threshold = 0.05)
get_average_tree(x,threshold = 0.1)
x = get_average_tree(x,threshold = 0.1)
x$inferred_tree
p1 = plot_multivariate(x)
p2 = plot_tree(x)
p = ggarrange(plotlist = list(p1,p2),ncol = 2,nrow = 1)
p = ggarrange(plotlist = list(p,p3),ncol = 1,nrow = 2)
p
x$VAF
posterior = get_posterior(x)
plot_inference(x)
source('~/Documents/GitHub/ProjectPepi/R/plot_functions.R')
x = get_posterior(x)
x
plot_inference(x)
plot_inference(x,params = c("rn","rp"))
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 45,
mu = 1e-7,l = 2.7*10^9,ms = -0.5, sigma = 0.5, k = 100)
source('~/Documents/GitHub/ProjectPepi/R/fitters.R')
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 45,
mu = 1e-7,l = 2.7*10^9,ms = -0.5, sigma = 0.5, k = 100)
x = get_posterior(x)
plot_inference(x,params = c("rn","rp","s"))
names(x$inference)
fit$inference$fitness
x$inference$fitness
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 45,
mu = 1e-7,l = 2.7*10^9,ms = 0, sigma = 0.5, k = 100)
x$inference$fitness
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 120,
mu = 1e-7,l = 2.7*10^9,ms = 0, sigma = 0.5, k = 100)
x$inference$fitness
x = get_posterior(x)
"fitness" %in% names(x$inference)
names(fit)
source('~/Documents/GitHub/ProjectPepi/R/getters.R')
x = get_posterior(x)
x$posterior
plot_inference(x,params = c("rn","rp","s"))
prior = rbind(as_tibble(x$prior$tree) %>% mutate(class = "tree"),
as_tibble(x$prior$fitness) %>% mutate(class = "fitness"),
as_tibble(x$prior$counts) %>% mutate(class = "counts")) %>%
mutate(type = "prior")  %>% reshape2::melt()
prior
post = rbind(as_tibble(x$posterior$tree) %>% mutate(class = "tree"),
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness"),
as_tibble(x$posterior$counts) %>% mutate(class = "counts")) %>%
mutate(type = "post")  %>% reshape2::melt()
as_tibble(x$posterior$tree) %>% mutate(class = "tree")
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness")
as_tibble(x$posterior$counts) %>% mutate(class = "counts")
rbind(as_tibble(x$posterior$tree) %>% mutate(class = "tree"),
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness"),
as_tibble(x$posterior$counts) %>% mutate(class = "counts"))
as_tibble(x$posterior$tree) %>% mutate(class = "tree")
cbind(as_tibble(x$posterior$tree) %>% mutate(class = "tree"),
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness"),
as_tibble(x$posterior$counts) %>% mutate(class = "counts"))
as_tibble(x$posterior$tree) %>% mutate(class = "tree")
rbind(as_tibble(x$prior$tree) %>% mutate(class = "tree") %>% reshape2::melt(),
as_tibble(x$prior$fitness) %>% mutate(class = "fitness") %>% reshape2::melt(),
as_tibble(x$prior$counts) %>% mutate(class = "counts") %>% reshape2::melt()) %>%
mutate(type = "prior")
rbind(as_tibble(x$posterior$tree) %>% mutate(class = "tree") %>% reshape2::melt(),
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness") %>% reshape2::melt(),
as_tibble(x$posterior$counts) %>% mutate(class = "counts") %>% reshape2::melt()) %>%
mutate(type = "post")
prior = rbind(as_tibble(x$prior$tree) %>% mutate(class = "tree") %>% reshape2::melt(),
as_tibble(x$prior$fitness) %>% mutate(class = "fitness") %>% reshape2::melt(),
as_tibble(x$prior$counts) %>% mutate(class = "counts") %>% reshape2::melt()) %>%
mutate(type = "prior")
post = rbind(as_tibble(x$posterior$tree) %>% mutate(class = "tree") %>% reshape2::melt(),
as_tibble(x$posterior$fitness) %>% mutate(class = "fitness") %>% reshape2::melt(),
as_tibble(x$posterior$counts) %>% mutate(class = "counts") %>% reshape2::melt()) %>%
mutate(type = "post")
sampling = rbind(prior,post)
if(!is.null(params)){
sampling = sampling %>% filter(variable %in% params)
}
if (is.null(sampling)) {
stop("required parameters are not present")
}
source('~/Documents/GitHub/ProjectPepi/R/plot_functions.R')
plot_inference(x,params = c("rn","rp","s"))
tree
x$inferred_tree
x = get_average_tree(x,threshold = 0.1)
x$inferred_tree
x$inferred_tree
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 150,
mu = 1e-7,l = 2.7*10^9,ms = 0, sigma = 0.5, k = 100)
x = get_posterior(x)
plot_inference(x,params = c("rn","rp","s"))
x$inferred_tree
x$inference$fitness
s = 0.25
vars = s/3
ms = log(s/sqrt(vars/(s**2)+1))
sigma = log(sqrt(vars/(s**2)+1))
ms
sigma
ggplot(data.frame(x = rlnorm(10000,ms,sigma))) + geom_histogram(aes(x = x))
source('~/Documents/GitHub/ProjectPepi/R/fitters.R')
ms
x = fit_s(x,path_to_model = "models",
cmdstan_path = "/.cmdstan/cmdstan-2.33.1",
threshold = 0.1,
ndraws = 1000,init = NULL,seed = 250,
mu = 1e-7,l = 2.7*10^9,ms = -1.8, sigma = 0.5, k = 1e3)
x$inference$fitness$cmdstan_summary()
ggplot(x$VAF) + geom_point(aes(x = VAFx,y =VAFy,fill = node))
x$VAF
ggplot(x$VAF) + geom_point(aes(x = VAFx,y =VAFy,color = node))
x = get_posterior(x)
plot_inference(x,params = c("rn","rp","s"))
source('~/Documents/GitHub/ProjectPepi/R/plot_functions.R')
p1 = plot_multivariate(x)
p2 = plot_tree(x)
library(Pepi)
M = 8000
