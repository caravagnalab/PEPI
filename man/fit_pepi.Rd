% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitters.R
\name{fit_pepi}
\alias{fit_pepi}
\title{Fit a PEPI model using Stan and update the PEPI object}
\usage{
fit_pepi(
  pepi,
  model_type = "logistic",
  ms_driver_n = NULL,
  sigma_driver_n = NULL,
  ms_dc = NULL,
  sigma_dc = NULL,
  ms_cd = NULL,
  sigma_cd = NULL,
  alpha_lambda = 1,
  beta_lambda = 1,
  alpha_plus = 10,
  beta_plus = 250,
  alpha_minus = 1,
  beta_minus = 1,
  alpha_n = 0.5,
  beta_n = 20,
  alpha_p = 0.2,
  beta_p = 10,
  t_min = 0,
  ms_epi = 0,
  sigma_epi = 0.5,
  ccf_thr_clade = 0.05,
  ccf_thr_count = 0.02,
  include_bp = FALSE,
  n_chains = 4,
  adapt_delta = 0.8,
  iter_warmup = 1000,
  iter_sampling = 1000
)
}
\arguments{
\item{pepi}{A PEPI object containing clade_statistics, Counts, and genomic_constants.}

\item{model_type}{Character. The model prior to use: "logistic" (default), "gumbel", or "log".}

\item{ms_driver_n}{Numeric vector. Prior mean for driver_n clusters. Default automatically set if NULL.}

\item{sigma_driver_n}{Numeric vector. Prior SD for driver_n clusters. Default automatically set if NULL.}

\item{ms_dc}{Numeric vector. Prior mean for DC clusters. Default automatically set if NULL.}

\item{sigma_dc}{Numeric vector. Prior SD for DC clusters. Default automatically set if NULL.}

\item{ms_cd}{Numeric vector. Prior mean for CD clusters. Default automatically set if NULL.}

\item{sigma_cd}{Numeric vector. Prior SD for CD clusters. Default automatically set if NULL.}

\item{alpha_lambda}{Numeric. Hyperparameter for lambda prior. Default 1.}

\item{beta_lambda}{Numeric. Hyperparameter for lambda prior. Default 1.}

\item{alpha_plus}{Numeric. Hyperparameter for positive epistate prior. Default 10.}

\item{beta_plus}{Numeric. Hyperparameter for positive epistate prior. Default 250.}

\item{alpha_minus}{Numeric. Hyperparameter for negative epistate prior. Default 1.}

\item{beta_minus}{Numeric. Hyperparameter for negative epistate prior. Default 1.}

\item{alpha_n}{Numeric. Hyperparameter for negative counts prior. Default 0.5.}

\item{beta_n}{Numeric. Hyperparameter for negative counts prior. Default 20.}

\item{alpha_p}{Numeric. Hyperparameter for positive counts prior. Default 0.2.}

\item{beta_p}{Numeric. Hyperparameter for positive counts prior. Default 10.}

\item{t_min}{Numeric. Minimum time prior. Default 0.}

\item{ms_epi}{Numeric. Prior mean for epistate. Default 0.}

\item{sigma_epi}{Numeric. Prior SD for epistate. Default 0.5.}

\item{ccf_thr_clade}{Numeric. Threshold for clade CCF. Default 0.05.}

\item{ccf_thr_count}{Numeric. Threshold for count CCF. Default 0.02.}

\item{include_bp}{Logical. Whether to include base pair information. Default FALSE.}

\item{n_chains}{Integer. Number of Stan chains. Default 4.}

\item{adapt_delta}{Numeric. Stan adapt_delta parameter. Default 0.8.}

\item{iter_warmup}{Integer. Number of warmup iterations. Default 1000.}

\item{iter_sampling}{Integer. Number of sampling iterations. Default 1000.}
}
\value{
A PEPI object updated with:
\item{stan_data}{The Stan data list used for fitting.}
\item{fit}{The fitted \code{cmdstanr::CmdStanMCMC} object.}
}
\description{
This function takes a PEPI object, fits a tumor evolutionary model
using Stan, and updates the PEPI object with the fitted model and Stan data.
}
\examples{
\dontrun{
pepi_object <- fit_pepi(pepi_object, model_type = "logistic")
}

}
